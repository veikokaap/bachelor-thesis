%!TEX root = ../presentation.tex
\documentclass[..presentation.tex]{subfiles}
\begin{document}
\def\FIDE{Debugger 1}
\def\SEDE{Debugger 2}
\def\FIDESEDE{Debugger 1<->Debugger 2}
\def\PRO{Proxy server}
\def\SEDEPRO{Debugger 2<->Proxy server}
\def\JVM{JVM}
\def\PROJVM{Proxy server<->JVM}

\begin{tikzpicture}[every node/.style={font=\normalsize,
  minimum height=0cm,minimum width=0.5cm}]
  \node [matrix, very thin,column sep=0cm,row sep=0.05cm] (matrix) at (0,0) {
   & \node(0,0) (\FIDE) {}; &[5.0ex] \node(0,0) (\FIDESEDE) {}; &[5.0ex] \node(0,0) (\SEDE) {}; &[11.0ex] \node(0,0) (\SEDEPRO) {}; &[11.0ex] \node(0,0) (\PRO) {}; &[11.5ex] \node(0,0) (\PROJVM) {}; &[11.5ex] \node(0,0) (\JVM) {}; & \\
   & \node(0,0) (\FIDE 0) {}; &[5.0ex] \node(0,0) (\FIDESEDE 0) {}; &[5.0ex] \node(0,0) (\SEDE 0) {}; &[11.0ex] \node(0,0) (\SEDEPRO 0) {}; &[11.0ex] \node(0,0) (\PRO 0) {}; &[11.5ex] \node(0,0) (\PROJVM 0) {}; &[11.5ex] \node(0,0) (\JVM 0) {}; & \\
   & \node(0,0) (\FIDE 1) {}; &[5.0ex] \node(0,0) (\FIDESEDE 1) {}; &[5.0ex] \node(0,0) (\SEDE 1) {}; &[11.0ex] \node(0,0) (\SEDEPRO 1) {}; &[11.0ex] \node(0,0) (\PRO 1) {}; &[11.5ex] \node(0,0) (\PROJVM 1) {}; &[11.5ex] \node(0,0) (\JVM 1) {}; & \\
   & \node(0,0) (\FIDE 2) {}; &[5.0ex] \node(0,0) (\FIDESEDE 2) {}; &[5.0ex] \node(0,0) (\SEDE 2) {}; &[11.0ex] \node(0,0) (\SEDEPRO 2) {}; &[11.0ex] \node(0,0) (\PRO 2) {}; &[11.5ex] \node(0,0) (\PROJVM 2) {}; &[11.5ex] \node(0,0) (\JVM 2) {}; & \\
   & \node(0,0) (\FIDE 3) {}; &[5.0ex] \node(0,0) (\FIDESEDE 3) {}; &[5.0ex] \node(0,0) (\SEDE 3) {}; &[11.0ex] \node(0,0) (\SEDEPRO 3) {}; &[11.0ex] \node(0,0) (\PRO 3) {}; &[11.5ex] \node(0,0) (\PROJVM 3) {}; &[11.5ex] \node(0,0) (\JVM 3) {}; & \\
   & \node(0,0) (\FIDE 4) {}; &[5.0ex] \node(0,0) (\FIDESEDE 4) {}; &[5.0ex] \node(0,0) (\SEDE 4) {}; &[11.0ex] \node(0,0) (\SEDEPRO 4) {}; &[11.0ex] \node(0,0) (\PRO 4) {}; &[11.5ex] \node(0,0) (\PROJVM 4) {}; &[11.5ex] \node(0,0) (\JVM 4) {}; & \\
   & \node(0,0) (\FIDE 5) {}; &[5.0ex] \node(0,0) (\FIDESEDE 5) {}; &[5.0ex] \node(0,0) (\SEDE 5) {}; &[11.0ex] \node(0,0) (\SEDEPRO 5) {}; &[11.0ex] \node(0,0) (\PRO 5) {}; &[11.5ex] \node(0,0) (\PROJVM 5) {}; &[11.5ex] \node(0,0) (\JVM 5) {}; & \\
   & \node(0,0) (\FIDE 6) {}; &[5.0ex] \node(0,0) (\FIDESEDE 6) {}; &[5.0ex] \node(0,0) (\SEDE 6) {}; &[11.0ex] \node(0,0) (\SEDEPRO 6) {}; &[11.0ex] \node(0,0) (\PRO 6) {}; &[11.5ex] \node(0,0) (\PROJVM 6) {}; &[11.5ex] \node(0,0) (\JVM 6) {}; & \\
   & \node(0,0) (\FIDE 7) {}; &[5.0ex] \node(0,0) (\FIDESEDE 7) {}; &[5.0ex] \node(0,0) (\SEDE 7) {}; &[11.0ex] \node(0,0) (\SEDEPRO 7) {}; &[11.0ex] \node(0,0) (\PRO 7) {}; &[11.5ex] \node(0,0) (\PROJVM 7) {}; &[11.5ex] \node(0,0) (\JVM 7) {}; & \\
   & \node(0,0) (\FIDE 8) {}; &[5.0ex] \node(0,0) (\FIDESEDE 8) {}; &[5.0ex] \node(0,0) (\SEDE 8) {}; &[11.0ex] \node(0,0) (\SEDEPRO 8) {}; &[11.0ex] \node(0,0) (\PRO 8) {}; &[11.5ex] \node(0,0) (\PROJVM 8) {}; &[11.5ex] \node(0,0) (\JVM 8) {}; & \\
   & \node(0,0) (\FIDE 9) {}; &[5.0ex] \node(0,0) (\FIDESEDE 9) {}; &[5.0ex] \node(0,0) (\SEDE 9) {}; &[11.0ex] \node(0,0) (\SEDEPRO 9) {}; &[11.0ex] \node(0,0) (\PRO 9) {}; &[11.5ex] \node(0,0) (\PROJVM 9) {}; &[11.5ex] \node(0,0) (\JVM 9) {}; & \\
   & \node(0,0) (\FIDE 10) {}; &[5.0ex] \node(0,0) (\FIDESEDE 10) {}; &[5.0ex] \node(0,0) (\SEDE 10) {}; &[11.0ex] \node(0,0) (\SEDEPRO 10) {}; &[11.0ex] \node(0,0) (\PRO 10) {}; &[11.5ex] \node(0,0) (\PROJVM 10) {}; &[11.5ex] \node(0,0) (\JVM 10) {}; & \\
   & \node(0,0) (\FIDE 11) {}; &[5.0ex] \node(0,0) (\FIDESEDE 11) {}; &[5.0ex] \node(0,0) (\SEDE 11) {}; &[11.0ex] \node(0,0) (\SEDEPRO 11) {}; &[11.0ex] \node(0,0) (\PRO 11) {}; &[11.5ex] \node(0,0) (\PROJVM 11) {}; &[11.5ex] \node(0,0) (\JVM 11) {}; & \\
   & \node(0,0) (\FIDE 12) {}; &[5.0ex] \node(0,0) (\FIDESEDE 12) {}; &[5.0ex] \node(0,0) (\SEDE 12) {}; &[11.0ex] \node(0,0) (\SEDEPRO 12) {}; &[11.0ex] \node(0,0) (\PRO 12) {}; &[11.5ex] \node(0,0) (\PROJVM 12) {}; &[11.5ex] \node(0,0) (\JVM 12) {}; & \\
   & \node(0,0) (\FIDE 13) {}; &[5.0ex] \node(0,0) (\FIDESEDE 13) {}; &[5.0ex] \node(0,0) (\SEDE 13) {}; &[11.0ex] \node(0,0) (\SEDEPRO 13) {}; &[11.0ex] \node(0,0) (\PRO 13) {}; &[11.5ex] \node(0,0) (\PROJVM 13) {}; &[11.5ex] \node(0,0) (\JVM 13) {}; & \\
   & \node(0,0) (\FIDE 14) {}; &[5.0ex] \node(0,0) (\FIDESEDE 14) {}; &[5.0ex] \node(0,0) (\SEDE 14) {}; &[11.0ex] \node(0,0) (\SEDEPRO 14) {}; &[11.0ex] \node(0,0) (\PRO 14) {}; &[11.5ex] \node(0,0) (\PROJVM 14) {}; &[11.5ex] \node(0,0) (\JVM 14) {}; & \\
  };

  \fill
    (\FIDE) node[draw,fill=blue!20] {\FIDE}
    (\SEDE) node[draw,fill=teal!20] {\SEDE}
    (\PRO) node[draw,fill=black!20] {\PRO}
    (\JVM) node[draw,fill=red!20] {\JVM}
  ;

  \draw
    (\FIDE14)
       node[draw,isosceles triangle, fill=black, rotate=-90]
        (\FIDE FIDEtime) {}
       node[below right] {$t$}
    (\SEDE14)
       node[draw,isosceles triangle, fill=black, rotate=-90]
        (\SEDE SEDEtime) {}
       node[below right] {$t$}
    (\PRO14)
       node[draw,isosceles triangle, fill=black, rotate=-90]
        (\PRO PROtime) {}
       node[below right] {$t$}
    (\JVM14)
       node[draw,isosceles triangle, fill=black, rotate=-90]
        (\JVM JVMtime) {}
       node[below right] {$t$}
  ;

  \draw[dashed]
    (\FIDE 0) -- (\FIDE 14)
    (\SEDE 0) -- (\SEDE 14)
    (\PRO 0) -- (\PRO 14)
    (\JVM 0) -- (\JVM 14)
  ;

  \filldraw[fill=red!20]
  (\JVM 2.north west) rectangle (\JVM 4.south east);

  \filldraw[fill=blue!20]
  (\FIDE 5.north west) rectangle (\FIDE 7.south east);

  \filldraw[fill=teal!20]
  (\SEDE 10.north west) rectangle (\SEDE 12.south east);

  \filldraw[fill=black!20]
  (\PRO 2.north west) rectangle (\PRO 12.south east);

  \draw [-latex, black]
    (\PRO 2) -- (\JVM 2);
  \fill
    (\PROJVM 2)
      node[, above=-0.1cm, text=black] {Handshake on port 5005};
  \draw [-latex, red]
    (\JVM 4) -- (\PRO 4);
  \fill
    (\PROJVM 4)
      node[, above=-0.1cm, text=red] {Reply on port 5005};
  \draw [-latex, blue]
    (\FIDE 5) -- (\SEDE 5.west) arc(180:0:0.25cm) --(\PRO 5);
  \fill
    (\SEDEPRO 5)
      node[, above=-0.1cm, text=blue] {Handshake on port 6006};
  \draw [-latex, black]
    (\PRO 7) -- (\SEDE 7.east) arc(0:180:0.25cm) --(\FIDE 7);
  \fill
    (\SEDEPRO 7)
      node[, above=-0.1cm, text=black] {Reply on port 6006};
  \draw [-latex, teal]
    (\SEDE 10) -- (\PRO 10);
  \fill
    (\SEDEPRO 10)
      node[, above=-0.1cm, text=teal] {Handshake on port 6006};
  \draw [-latex, black]
    (\PRO 12) -- (\SEDE 12);
  \fill
    (\SEDEPRO 12)
      node[, above=-0.1cm, text=black] {Reply on port 6006};

\end{tikzpicture}
\captionof{figure}{\it{Illustration of handshakes between JVM, debuggers and the proxy server.}}
\label{graph:handshake-proxy}
\end{document}
